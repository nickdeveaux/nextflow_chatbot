# Shared configuration for Nextflow Chat Assistant
# Values can be overridden via environment variables

# API Configuration
api:
  # Service account: Set via GOOGLE_SERVICE_ACCOUNT_JSON (env, recommended) or SERVICE_ACCOUNT_PATH (env/file path)
  # Priority: GOOGLE_SERVICE_ACCOUNT_JSON (env) > SERVICE_ACCOUNT_PATH (env) > service_account_path (yaml)
  # For Railway: Use GOOGLE_SERVICE_ACCOUNT_JSON env var with JSON content, or upload file and set SERVICE_ACCOUNT_PATH
  service_account_path: ""  # Leave empty - set via environment variables (see README.md)
  gemini_api_base_url: "https://generativelanguage.googleapis.com/v1beta"
  gemini_model: "gemini-2.0-flash-exp"

# LLM Configuration
# All settings can be overridden via environment variables
llm:
  model: "gemini-2.0-flash-exp"  # Vertex AI model name (env: LLM_MODEL)
  temperature: 0.7  # Model temperature (env: LLM_TEMPERATURE)
  max_tokens: 1000  # Maximum output tokens (env: LLM_MAX_TOKENS)
  max_input_length: 500000  # Maximum characters allowed in input message (env: MAX_INPUT_LENGTH)

# System Prompt
system_prompt: |
  You are a helpful Nextflow documentation assistant. You answer questions about Nextflow with accuracy and clarity.

  Nextflow is a workflow management system for data-intensive computational pipelines. It enables scalable and reproducible scientific workflows using a simple DSL (Domain-Specific Language).

  You are expected to provide documentation Q&A about Nextflow features, syntax, and capabilities and pragmatic troubleshooting guidance

  When you have relevant context from documentation, use it. When something is unknown, be transparent and suggest how to verify it (e.g., check the docs at https://www.nextflow.io/docs/latest/).

  Keep responses concise but informative. If asked for citations, provide them.

  Some more information about Nextflow:
  Origin: *"Dataflow variables are spectacularly expressive in concurrent programming"*
  <br>[Henri E. Bal , Jennifer G. Steiner , Andrew S. Tanenbaum](https://dl.acm.org/doi/abs/10.1145/72551.72552)

  Nextflow is a workflow system for creating scalable, portable, and reproducible workflows. It is based on the dataflow programming model, which greatly simplifies the writing of parallel and distributed pipelines, allowing you to focus on the flow of data and computation. Nextflow can deploy workflows on a variety of execution platforms, including your local machine, HPC schedulers, AWS Batch, Azure Batch, Google Cloud Batch, and Kubernetes. Additionally, it supports many ways to manage your software dependencies, including Conda, Spack, Docker, Podman, Singularity, and more.
  
  ## Quick start
  
  Install Nextflow with a single command:
  
  ```bash
  curl -fsSL https://get.nextflow.io | bash
  ```
  
  It creates the `nextflow` executable file in the current directory. You can then move it to a directory in your `$PATH` to run it from anywhere.
  
  Nextflow can also be installed from Bioconda:
  
  ```bash
  conda install -c bioconda nextflow
  ```
  Common Pitfalls in Nextflow Usage
Many user errors arise from subtle mismatches between DSL1 and DSL2 syntax, misconfigured executors, or missing output files. When a user mentions operators like into, from, or an “operator not found” error, suspect a DSL mismatch—especially if nextflow.enable.dsl=2 is missing at the top of the script. If the issue concerns job submission or scheduler keywords such as “slurm,” “awsbatch,” or “executor,” guide them to inspect their process.executor configuration and confirm the active executor using nextflow config | grep executor. When a process fails with “Missing output file(s) expected by process,” it often means the declared output pattern doesn’t match what the command actually produced, or files were written to the wrong directory.

Environment, Resource, and Version Problems
Resource exhaustion is another recurring cause of task failure. Exit codes 137 or 143 typically mean the process was terminated by the system for using too much memory or exceeding its time limit. In such cases, suggest increasing the memory or time directive in the configuration and possibly using errorStrategy 'retry' with scaled resources. Environment mismatches also cause reproducibility issues; remind users to check their Nextflow version with nextflow -version, and to pin versions explicitly using NXF_VER=... nextflow run ... for consistent results across environments.

Actionable Next Steps for Debugging
Always recommend verifying the problem locally. Users can inspect the failing task directory (e.g., work/xx/yyyy.../) and run .command.run or .command.sh manually to see what failed. Encourage short, testable commands to isolate the issue—such as re-running one process with -resume after adjusting resources or syntax

  ## Documentation
  
  The Nextflow documentation is available for the latest [stable](https://nextflow.io/docs/latest/) and [edge](https://nextflow.io/docs/edge/) releases.
  
  ## Community
  
  You can post questions and get help in the [Nextflow community forum](https://community.seqera.io) or the [Nextflow Slack](https://www.nextflow.io/slack-invite.html). Bugs and feature requests should be reported as [GitHub issues](https://github.com/nextflow-io/nextflow/issues/new/choose).
  
  The Nextflow community is highly active with regular community meetings, events, a podcast and more. 

  The [nf-core](https://nf-co.re/) project is a community effort aggregating high quality Nextflow workflows which can be used by everyone.
  
  ## Contributing
  
  Contributions are more than welcome. 

  ## License
  
  Nextflow is released under the Apache 2.0 license. Nextflow is a [registered trademark](https://github.com/nextflow-io/trademark).
  
  ## Citations
  
  If you use Nextflow in your work, please cite:
  
  P. Di Tommaso, et al. Nextflow enables reproducible computational workflows. Nature Biotechnology 35, 316–319 (2017) doi:[10.1038/nbt.3820](http://www.nature.com/nbt/journal/v35/n4/full/nbt.3820.html)
  
  ## Credits
  
  Nextflow is built on two \*great* open-source software projects, <a href='http://groovy-lang.org' target='_blank'>Groovy</a>
  and <a href='http://www.gpars.org/' target='_blank'>GPars</a>.
  
  <a href='http://www.yourkit.com' target='_blank'>YourKit</a> is kindly supporting Nextflow with its fully-featured Java Profiler.
  
  Current version: 25.10.0



# Vector Store Configuration
# For Railway: Uses /app/data for persistent storage (auto-detected in container)
# For local dev: Uses ./vector_index.index (auto-detected locally)
# If NEXTFLOW_DOCS_DIR is not set, vector store will work without docs (LLM-only mode)
vector_store:
  nextflow_docs_dir: ""  # Optional: Set via NEXTFLOW_DOCS_DIR env var or leave empty for LLM-only
  index_path: ""  # Auto-detected: /app/data/vector_index.index in container, ./vector_index.index locally (env: VECTOR_INDEX_PATH)
  # Path resolution: index_path (yaml) > /app/data/vector_index.index (if /app exists) > ./vector_index.index (local)
  search_top_k: 5  # Number of results to return (env: VECTOR_SEARCH_TOP_K)
  search_threshold: 0.4  # Minimum similarity score (env: VECTOR_SEARCH_THRESHOLD)

# CORS Configuration
# All settings can be overridden via environment variables
cors:
  allowed_origins:  # Comma-separated list in env: CORS_ORIGINS
    # Add your frontend URLs here (or use CORS_ORIGINS env var)
    - "http://localhost:3000"  # Local development (Next.js default)
    - "http://localhost:3001"  # Local development (alternate port)
    - "http://127.0.0.1:3000"  # Local development
    - "http://127.0.0.1:3001"  # Local development (alternate port)
    - "http://localhost"  # For accessing frontend via localhost
    - "http://127.0.0.1"  # For accessing frontend via 127.0.0.1
    # Add your production frontend URL here (e.g., your Vercel deployment)
    # Or set CORS_ORIGINS env var with comma-separated list
  allow_vercel_domains: true  # Allow all *.vercel.app domains via regex (env: CORS_ALLOW_VERCEL_DOMAINS)
  vercel_domain_regex: "https?://.*\\.vercel\\.app.*"  # Regex pattern for Vercel domains (env: CORS_VERCEL_DOMAIN_REGEX)
  allow_credentials: true  # Allow credentials in CORS requests (env: CORS_ALLOW_CREDENTIALS)
  allowed_methods: ["GET", "POST", "OPTIONS"]  # Allowed HTTP methods (env: CORS_ALLOWED_METHODS, comma-separated)
  allowed_headers: ["*"]  # Allowed headers (env: CORS_ALLOWED_HEADERS, comma-separated)

# Frontend Configuration
frontend:
  loading_messages:
    - "Thinking"
    - "Pondering"
    - "Noodling"
    - "Considering"
    - "Examining"
    - "Researching"
    - "Reflecting"
    - "Evaluating"
    - "Deliberating"
  api_url: "http://localhost:8000"  # Default for local dev - override with NEXT_PUBLIC_API_URL env var
  # Production (Vercel frontend + Railway backend): Set NEXT_PUBLIC_API_URL=https://your-backend.railway.app
  # For local IP access: Set NEXT_PUBLIC_API_URL=http://your-ip:8000
  # See SETUP_LOCAL.md for local development setup

